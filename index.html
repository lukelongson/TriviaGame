<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>True / False Trivia</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios@1.13.2/dist/axios.min.js"></script>
</head>
<body>
  <main class="app">
    <header class="header">
      <h1 class="title">True / False Trivia</h1>
      <p class="subtitle">Decide quickly â€” is it true or false?</p>
    </header>

    <section class="game" aria-label="Trivia game">
      <!-- Question area (update this text with JS) -->
      <div id="question" class="question" aria-live="polite">
        [PLACEHOLDER]
      </div>

      <!-- Buttons for user input -->
      <div class="controls">
        <button id="trueBtn" class="btn true" type="button" aria-pressed="false">True</button>
        <button id="falseBtn" class="btn false" type="button" aria-pressed="false">False</button>
      </div>
  </main>

  <script>

    // Get Questions and load local storage
      const getQuestionsAndLoadLocalStorage = async () =>{
        let {data} = await axios.get("https://opentdb.com/api.php?amount=10&type=boolean");
        localStorage.setItem("trivia",JSON.stringify(data.results));
      }

    // Grab questions from storage and display and set correct answer
      const getQuestionFromStorage = async() =>{

      // Check if there are questions remaining, if not grab new ones
        if(!localStorage.getItem("trivia")){
          await getQuestionsAndLoadLocalStorage();
        }
        
        // Grab questions and set correct answer and display
        let questions = JSON.parse(localStorage.getItem("trivia"));
        let {question,correct_answer} = questions.pop();


        // Reset Localstorage based on remaining questions
        if(questions.length <= 0){
          localStorage.removeItem("trivia");
        } else {
          localStorage.setItem("trivia",JSON.stringify(questions));
        }
        // Set correct answer and display question
        sessionStorage.setItem("correct answer", correct_answer);
        $("#question").html(question);
      }

      const checkAnswer = (e) => {
        // Check if button has the correct text
        if(e.target.innerText === sessionStorage.getItem("correct answer")){
          alert("Correct!");
          getQuestionFromStorage();
        } else {
          alert("Try Again");
        }
      }

      // Add event listeners
$("#trueBtn").click(checkAnswer);
$("#falseBtn").click(checkAnswer);

$("body").ready(getQuestionFromStorage());

  </script>
</body>
</html>